



<!doctype html>
<html lang="en-us">
  <head>

    <title>Updating DG&#39;s Collection Views // The Grinnell College Digital Library Application Developer&#39;s Blog</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.87.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Mark A. McFate" />
    <meta name="description" content="" />
    
    <link rel="stylesheet" href="https://digital-grinnell.github.io/dlad-blog/css/main.8a32dadea1834ef74fe59f5362dbaaa416e123d8600158d361ad3d96945c0aa5.css" />

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-4766052-14', 'auto');
	
	ga('send', 'pageview');
}
</script>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Updating DG&#39;s Collection Views"/>
<meta name="twitter:description" content="Digital.Grinnell employs a custom-built Drupal &ldquo;view&rdquo; we call the dg7 Collection View; it&rsquo;s part of the code in our custom dg7 module where all of Digital.Grinnell&rsquo;s hook implementations are also defined. Experience leads me to beleive that keeping a complex Drupal view in code is prudent, but overriding that code with a database copy of the view helps tremendously in terms of system performance. So, I recommend keeping the view code in the module, but that means that when significant changes are made, like the addition of a new colleciton, the code should be updated in the database to speed things up."/>

    <meta property="og:title" content="Updating DG&#39;s Collection Views" />
<meta property="og:description" content="Digital.Grinnell employs a custom-built Drupal &ldquo;view&rdquo; we call the dg7 Collection View; it&rsquo;s part of the code in our custom dg7 module where all of Digital.Grinnell&rsquo;s hook implementations are also defined. Experience leads me to beleive that keeping a complex Drupal view in code is prudent, but overriding that code with a database copy of the view helps tremendously in terms of system performance. So, I recommend keeping the view code in the module, but that means that when significant changes are made, like the addition of a new colleciton, the code should be updated in the database to speed things up." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://digital-grinnell.github.io/dlad-blog/posts/068-updating-dgs-collection-views/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-06-24T22:07:52-05:00" />



  </head>

  <body>

    
    <header class="app-header">

      

      <a href="https://digital-grinnell.github.io/dlad-blog/"><img class="app-header-avatar" src="https://digital-grinnell.github.io/dlad-blog/avatar.jpg" alt="Mark A. McFate" /></a>
      <h2>The Grinnell College Digital Library Application Developer&#39;s Blog</h2>

      <div class="author-block">

        

        <p class="site-rev">
          Compiled: Oct 4, 2021 at 4:22pm CDT<br/>
          Content Updated: 2021-Sep-15 08:11 CDT
        </p>

        <div class="name">by
        <strong>Mark A. McFate</strong></div>
        <div class="address">Grinnell College Libraries</div>
        <div class="link"><a href="mailto:"></a></div>
        <br/>
      </div>

      <nav class="sidebar-nav">
        
        
        <a class="sidebar-nav-item" href="https://digital-grinnell.github.io/dlad-blog/search/" title="">Search This Blog</a>
        
        <a class="sidebar-nav-item" href="https://digital-grinnell.github.io/dlad-blog/about/" title="">About Me</a>
        
      </nav>

      <p class="site-description">Mark&#39;s first Hugo site, a blog, formerly at Static.Grinnell.edu now hosted on GitHub Pages.</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/McFateM"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
          <a target="_blank" href="https://twitter.com/gohugoio"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg></a>
        
      </div>
      <p class="copyright">The views and opinions expressed on this site belong solely to the original author(s) and do not necessarily represent or reflect those of Grinnell College.</p>
    </header>

    
    <main class="app-container">
      <div class="breadcrumbs">
  
  
  <a href="https://digital-grinnell.github.io/dlad-blog/">Home</a>
  
    
    
    
      &bullet; <a href='https://digital-grinnell.github.io/dlad-blog/posts/'>Posts</a>
      
    
  
    
    
    
      &bullet; <a href='https://digital-grinnell.github.io/dlad-blog/posts/068-updating-dgs-collection-views/'>068 updating dgs collection views</a>
      
    
  
    
    
    
  
</div>

      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Updating DG&#39;s Collection Views</h1>
      <div class="post-meta">

        
        

        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          3 min read
          &nbsp;&nbsp;&bullet;&nbsp;&nbsp;
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Mar 17, 2020
          
            &nbsp;&nbsp;&bullet;&nbsp;&nbsp;Updated: Jun 24, 2020 - 22:07
          
          
            &nbsp;&nbsp;&bullet;&nbsp;&nbsp;<strong><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-at-sign">
  <title>at-sign</title>
  <circle cx="12" cy="12" r="4"></circle><path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94"></path>
</svg> Mark A. McFate</strong>
          <div>
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://digital-grinnell.github.io/dlad-blog/tags/digital.grinnell/">Digital.Grinnell</a></div></div>
    </header>
    <div class="post-content">
      <p><a href="https://digital.grinnell.edu">Digital.Grinnell</a> employs a custom-built <em>Drupal</em> &ldquo;view&rdquo; we call the <em>dg7 Collection View</em>; it&rsquo;s part of the code in our custom <a href="https://github.com/DigitalGrinnell/dg7">dg7 module</a> where all of <em>Digital.Grinnell</em>&rsquo;s hook implementations are also defined.  Experience leads me to beleive that keeping a complex <em>Drupal</em> view in code is prudent, but overriding that code with a database copy of the view helps tremendously in terms of system performance. So, I recommend keeping the view code in the module, but that means that when significant changes are made, like the addition of a new colleciton, the code should be updated in the database to speed things up.  <em>Digital.Grinnell</em> employs the following workflow to keep the view in code, but allow it to be selectively updated in the database as needed:</p>
<ol>
<li>
<p>Put the site into <em>Maintenance Mode</em>.  <em>Drupal</em>&rsquo;s default behavior with views in code is to reload and cache views every time they are needed.  If/when the cache is cleared or expires this default process can be quite time-consuming, so it&rsquo;s prudent to take control. Putting the site into <em>Maintenance Mode</em> helps in this regard because the <em>dg7</em> module is coded to ONLY update the <em>dg7 Collection View</em> while the site is in that mode.</p>
</li>
<li>
<p>Visit the <a href="https://digital.grinnell.edu/admin/structure/views">admin/structure/views page</a> and DELETE the existing <em>dg7 Collection View</em> from the database.  Deleting the view triggers the system to re-populate it, something that only happens if the site is in <em>Maintenance Mode</em>.</p>
</li>
<li>
<p>Clear all caches to complete the reset of <em>dg7 Collection View</em>.  An easy way to do this is to execute the following command on the <em>DGDocker1</em> host:</p>
</li>
</ol>
<pre><code>docker exec -w /var/www/html/sites/default isle-apache-dg drush cc all
</code></pre><p>When you return to the site you should now see messages like this:</p>
<pre><code>dg7_views_default_views has been called in MAINTENANCE MODE and dg7_collection does not exist so it will be created.

Note that you MUST alter the new dg7_Collection view in order to secure the new definitions in the database! It's easy, just edit the view and update all display titles to be empty. Do NOT delete the existing dg7_Collection view again unless you want to force an update from this code in MAINTENACE MODE!
</code></pre><ol start="4">
<li>
<p>Force the view to refresh back into the database. Visit the <a href="https://digital.grinnell.edu/admin/structure/views">admin/structure/views page</a>, click <code>Edit</code> for the <em>dg7 Collection View</em>, click <code>Title: none</code>, then click <code>Apply (all displays)</code>, and finally click <code>Save</code>.  This action changes NOTHING, but it does force the view back into the database where the <em>dg7</em> module code is overridden.</p>
</li>
<li>
<p>Take the site out of <em>Maintenance Mode</em>.  Visit the site&rsquo;s <a href="https://digital.grinnell.edu/admin/config/development/maintenance">admin/config/development/maintenance page</a>, remove the <em>Maintenance Mode</em> checkmark, and click <code>Save configuration</code>.</p>
</li>
</ol>
<p>This workflow was written for the production instance of <a href="https://digital.grinnell.edu">Digital.Grinnell</a>, but the same can be applied to local development or staging instances of <em>Digital.Grinnell</em> simply by changing URLs as needed.</p>
<p>And that&rsquo;s a wrap.  Until next time&hellip; 😄</p>

    </div>
    <div class="post-footer">
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "digital-library-applications-developer-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </article>

    </main>

    

  </body>

</html>
