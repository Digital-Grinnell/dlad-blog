<!doctype html><html lang=en-us><head><title>Rebuilding ISLE-ld (for Local Development) // The Grinnell College Digital Library Application Developer's Blog</title><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Mark A. McFate"><meta name=description content><link rel=stylesheet href=https://static.grinnell.edu/dlad-blog/css/main.min.bc1abb622a656fb4c816fed09d36c15e272b31b7beae2e7113b2f9418bff0361.css><script type=text/javascript src=https://static.grinnell.edu/dlad-blog/js/pdf-js/build/pdf.js></script><meta name=twitter:card content="summary"><meta name=twitter:title content="Rebuilding ISLE-ld (for Local Development)"><meta name=twitter:description content="This post replaces my earlier post 021 with the same title. It is intended to chronicle my efforts to build a new ISLE v1.3.0 local development instance of Digital.Grinnell on my work-issued MacBook Air, MA7053.
Goal The goal of this project is to spin up a pristine, local Islandora stack using the ISLE project at https://github.com/Digital-Grinnell/dg-isle/, then introduce elements like the Digital Grinnell theme and custom modules like DG7. Once these pieces are in-place and working, I&rsquo;ll begin adding other critical components as well as a robust set of data gleaned from https://digital."><meta property="og:title" content="Rebuilding ISLE-ld (for Local Development)"><meta property="og:description" content="This post replaces my earlier post 021 with the same title. It is intended to chronicle my efforts to build a new ISLE v1.3.0 local development instance of Digital.Grinnell on my work-issued MacBook Air, MA7053.
Goal The goal of this project is to spin up a pristine, local Islandora stack using the ISLE project at https://github.com/Digital-Grinnell/dg-isle/, then introduce elements like the Digital Grinnell theme and custom modules like DG7. Once these pieces are in-place and working, I&rsquo;ll begin adding other critical components as well as a robust set of data gleaned from https://digital."><meta property="og:type" content="article"><meta property="og:url" content="https://static.grinnell.edu/dlad-blog/posts/058-rebuilding-isle-ld/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-12-01T00:00:00+00:00"><meta property="article:modified_time" content="2019-12-04T10:57:46-05:00"><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://analytics.summittservices.com/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","16"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></head><body><header class=app-header><a href=https://static.grinnell.edu/dlad-blog/><img class=app-header-avatar src=https://static.grinnell.edu/dlad-blog/avatar.jpg alt="Mark A. McFate"></a><h2>The Grinnell College Digital Library Application Developer's Blog</h2><div class=author-block><p class=site-rev>Compiled: Mar 17, 2023 at 8:47am CDT<br>Content Updated: 2023-Mar-17 08:25 CDT</p><div class=name>by
<strong>Mark A. McFate</strong></div><div class=address>Grinnell College Libraries</div><div class=link><a href=mailto:></a></div><br></div><nav class=sidebar-nav><a class=sidebar-nav-item href=https://static.grinnell.edu/dlad-blog/search/ title>Search This Blog</a>
<a class=sidebar-nav-item href=https://static.grinnell.edu/dlad-blog/about/ title>About Me</a></nav><p class=site-description>Mark&rsquo;s first Hugo site, a blog, formerly on prem at Static.Grinnell.edu, moved to <em>DigitalOcean</em>, then to <em>Azure</em>, and now hosted on <em>GitHub Pages</em>.</p><div class=app-header-social><a target=_blank href=https://github.com/McFateM><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a target=_blank href=https://twitter.com/gohugoio><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter"><title>twitter</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></div><p class=copyright>The views and opinions expressed on this site belong solely to the original author(s) and do not necessarily represent or reflect those of Grinnell College.</p></header><main class=app-container><div class=breadcrumbs><a href=https://static.grinnell.edu/dlad-blog/>Home</a>
&bull; <a href=https://static.grinnell.edu/dlad-blog/posts/>Posts</a>
&bull; <a href=https://static.grinnell.edu/dlad-blog/posts/058-rebuilding-isle-ld/>058 rebuilding isle ld</a></div><article class=post><header class=post-header><h1 class=post-title>Rebuilding ISLE-ld (for Local Development)</h1><div class=post-meta><script>console.log("Hugo Debug: ",JSON.parse('"2019-12-02T00:00:00Z"'))</script><script>console.log("Hugo Debug: ",JSON.parse('"2019-12-04T10:57:46-05:00"'))</script><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>11 min read
&nbsp;&nbsp;&bull;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
Dec 1, 2019
&nbsp;&nbsp;&bull;&nbsp;&nbsp;Updated: Dec 4, 2019 10:57
&nbsp;&nbsp;&bull;&nbsp;&nbsp;<strong><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-at-sign"><title>at-sign</title><circle cx="12" cy="12" r="4"/><path d="M16 8v5a3 3 0 006 0v-1a10 10 0 10-3.92 7.94"/></svg> Mark A. McFate</strong><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/isle/>ISLE</a><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/local/>local</a><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/development/>development</a></div></div></header><div class=post-content><p>This post replaces my earlier post 021 with the same title. It is intended to chronicle my efforts to build a new ISLE v1.3.0 <code>local development</code> instance of <em>Digital.Grinnell</em> on my work-issued MacBook Air, <code>MA7053</code>.</p><h2 id=goal>Goal</h2><p>The goal of this project is to spin up a pristine, local Islandora stack using <a href=https://github.com/Islandora-Collaboration-Group/ISLE/>the ISLE project</a> at <a href=https://github.com/Digital-Grinnell/dg-isle/>https://github.com/Digital-Grinnell/dg-isle/</a>, then introduce elements like the <a href=https://github.com/DigitalGrinnell/digital_grinnell_theme/>Digital Grinnell theme</a> and custom modules like <a href=https://github.com/DigitalGrinnell/dg7/>DG7</a>. Once these pieces are in-place and working, I&rsquo;ll begin adding other critical components as well as a robust set of data gleaned from <a href=https://digital.grinnell.edu/>https://digital.grinnell.edu/</a>.</p><h2 id=using-this-document>Using This Document</h2><p>There are just a couple of notes regarding this document that I&rsquo;d like to pass along to make it more useful.</p><ul><li><p><strong>Gists</strong> - You will find a few places in this post where I generated a <a href=https://help.github.com/en/articles/creating-gists>gist</a> to take the place of lengthy command output. Instead of a long stream of text you&rsquo;ll find a simple <a href=https://gist.github.com/McFateM/98d09fdcc29f88ac88bf7b3cbfb8324d>link to a gist</a> like this.</p></li><li><p><strong>Workstation Commands</strong> - There are lots of places in this document where I&rsquo;ve captured a series of command lines along with output from those commands in block text. Generally speaking, after each such block you will find a <strong>Workstation Commands</strong> table that can be used to conveniently copy and paste the necessary commands directly into your workstation. The tables look something like this:</p></li></ul><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>cd ~/Projects<br>git clone <a href=https://github.com/DigitalGrinnell/ISLE>https://github.com/DigitalGrinnell/ISLE</a><br>cd ISLE<br>git checkout -b ld</td></tr></tbody></table><ul><li><strong>Apache Container Commands</strong> - Similar to <code>Workstation Commands</code>, a tabulated list of commands may appear with a heading of <strong>Apache Container Commands</strong>. *Commands in such tables can be copied and pasted into your command line terminal, but ONLY after you have opened a shell into the <em>Apache</em> container. The asterisk (*) at the end of the table heading is there to remind you of this! See the <a href=#opening-a-shell-in-the-apache-container>next section</a> of this document for additional details. These tables looks something like this:</li></ul><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/all/modules/contrib<br>drush dl backup_migrate<br>drush -y en backup_migrate</td></tr></tbody></table><h2 id=opening-a-shell-in-the-apache-container>Opening a Shell in the Apache Container</h2><p>This is something I find myself doing quite often during ISLE configuration, so here&rsquo;s a reminder of how I generally do this&mldr;</p><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>cd ~/Projects/ISLE<br>docker exec -it isle-apache-ld bash</td></tr></tbody></table><h2 id=cloning-to-local>Cloning to Local</h2><p>The first step is to clone my fork of <em>ISLE</em>, namely <a href=https://github.com/Digital-Grinnell/dg-isle.git>dg-isle</a>, to my workstation at <code>~/Projects/GitHub/dg-isle</code>, checkout the <code>local-dg-fedora</code> branch there, and begin, like so&mldr;</p><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>cd ~/Projects/GitHub<br>git clone <a href=https://github.com/Digital-Grinnell/dg-isle.git>https://github.com/Digital-Grinnell/dg-isle.git</a><br>cd dg-isle<br>git checkout local-dg-fedora</td></tr></tbody></table><h2 id=cleaning-up>Cleaning Up</h2><p>I typically use the following command stream to clean up any <em>Docker</em> cruft before I begin anew. Note: Uncomment the third line ONLY if you want to delete images and download new ones. If you do, be patient, it could take several minutes depending on connection speed.</p><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>docker stop $(docker ps -q)<br>docker rm -v $(docker ps -qa)<br># docker image rm $(docker image ls -q) &ndash;force<br>docker system prune &ndash;force</td></tr></tbody></table><h2 id=connecting-to-fedora>Connecting to FEDORA</h2><p>The <code>docker-compose.override.yml</code> file in the <code>local-dg-fedora</code> branch of my <a href=https://github.com/Digital-Grinnell/dg-isle>dg-isle</a> project includes 3 lines that direct <em>FEDORA</em> and <em>FGSearch</em> to use the mounted and pre-configured <code>/Volumes/DG-FEDORA</code> USB stick for object storage. The commands and process required to use the USB stick are presented in <a href=https://static.grinnell.edu/dlad-blog/posts/046-dg-fedora-a-portable-object-repository/>post 046, &ldquo;DG-FEDORA: A Portable Object Repository&rdquo;</a>.</p><h2 id=restarting-the-stack>Restarting the Stack</h2><p>Moving to <a href=https://github.com/Digital-Grinnell/dg-isle/blob/master/docs/install/install-local-new.md#step-7-launch-process>Step 7</a> in the install <a href=https://github.com/Digital-Grinnell/dg-isle/blob/master/docs/install/>documentation</a> produced <a href=@TODO:add-missing-link-here>this gist</a>.</p><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>cd ~/Projects/GitHub/dg-isle<br>time docker-compose up -d</td></tr></tbody></table><h2 id=running-the-drupal-installer-script>Running the Drupal Installer Script</h2><p>Moving on to <a href=https://github.com/Digital-Grinnell/dg-isle/blob/master/docs/install/install-local-new.md#step-8-run-islandora-drupal-site-install-script>Step 8 according to the documentation</a>&mldr;</p><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>cd ~/Projects/GitHub/dg-isle<br>time docker exec -it isle-apache-ld bash /utility-scripts/isle_drupal_build_tools/isle_islandora_installer.sh</td></tr></tbody></table><p>It was at this point I discovered a new gem in <code>iTerm2</code>: If you hit <code>Command + shift + A</code> the terminal will select/highlight all of the output from the last command. Exactly what I was hoping for. I&rsquo;ve copied all that output and stuck it in <a href=https://gist.github.com/Digital-Grinnell/dbdc3a2f46dc5c3bbf7176e1384202d5>this gist</a> rather than pasting it all here.</p><h2 id=testing-the-site>Testing the Site</h2><p>Moving on to <a href=https://github.com/Digital-Grinnell/dg-isle/blob/master/docs/install/install-local-new.md#step-9-test-the-site>Step 9 in the documentation</a>&mldr;</p><p>A web browser visit to <a href=https://dg.localdomain/>https://dg.localdomain/</a> shows that the standard <em>ISLE</em> stack is working~, and I was able to successfully login as <code>admin</code> with my super-secret password.</p><h2 id=installing-the-dg-theme>Installing the DG Theme</h2><p><a href=https://github.com/Digital-Grinnell/dg-isle/blob/master/docs/install/install-local-new.md#step-10-ingest-sample-objects>Step 10 in the documentation</a> calls for ingest of some sample objects, but this is where I depart from the script since I&rsquo;ve done this a number of times before.</p><p>So my focus here turned to installing the <a href=https://github.com/DigitalGrinnell/digital_grinnell_bootstrap>digital_grinnell_bootstrap</a> theme instead. Initially I did this with a pair of <code>git clone...</code> commands, but later in this process I&rsquo;m tasked with saving my <em>Islandora / Drupal</em> code as-a-whole into a larger <em>Git</em> repository that will include these themes. Cloning a <em>Git</em> repository inside another can lead to significant workflow problems, so lets use <em>Git</em> <code>submodules</code> instead.</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/all/themes<br>git submodule add -b 7.x-3.x <a href=https://github.com/drupalprojects/bootstrap.git>https://github.com/drupalprojects/bootstrap.git</a><br>chown -R islandora:www-data *<br>mkdir -p /var/www/html/sites/default/themes<br>cd /var/www/html/sites/default/themes<br>git submodule add <a href=https://github.com/DigitalGrinnell/digital>https://github.com/DigitalGrinnell/digital</a>_grinnell_bootstrap.git<br>chown -R islandora:www-data *<br>cd /var/www/html/sites/default<br>drush -y pm-enable bootstrap digital_grinnell_bootstrap<br>drush vset theme_default digital_grinnell_bootstrap</td></tr></tbody></table><p>Success! The theme is in place and active on my <a href=https://dg.localdomain/>dg.localdomain</a> site. Just one more tweak here&mldr;</p><p>I visited <a href="https://dg.localdomain/#overlay=admin/appearance/settings/digital_grinnell_bootstrap">#overlay=admin/appearance/settings/digital_grinnell_bootstrap</a> and made sure ONLY the following boxes are checked:</p><ul><li>Logo</li><li>Shortcut Icon</li><li>Use the default logo</li><li>Use the default shortcut icon</li></ul><p>All other theme settings should be default values and need not be changed.</p><p>A visit to <a href=https://dg.localdomain/>the site</a> with a refresh showed that this worked!</p><h2 id=install-the-islandora-multi-importer-imi>Install the Islandora Multi-Importer (IMI)</h2><p>It&rsquo;s important that we take this step BEFORE any that follow, otherwise the module will not install properly for reasons unknown. Note that I&rsquo;m installing a <em>Digital.Grinnell</em>-specific fork of the module here, and the process is this:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/all/modules/islandora<br>git submodule add <a href=https://github.com/DigitalGrinnell/islandora>https://github.com/DigitalGrinnell/islandora</a>_multi_importer.git<br>chown -R islandora:www-data *<br>cd islandora_multi_importer<br>composer install<br>drush -y en islandora_multi_importer</td></tr></tbody></table><h2 id=install-the-missing-backup-and-migrate-module>Install the Missing <em>Backup and Migrate</em> Module</h2><p>The <em>Backup and Migrate</em> module will be needed to quickly get our new <em>ISLE</em> configured as we&rsquo;d like. Install it like so:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/all/modules/contrib<br>drush dl backup_migrate<br>drush -y en backup_migrate</td></tr></tbody></table><h2 id=backup-and-restore-the-database-using-backup-and-migrate>Backup and Restore the Database Using <em>Backup and Migrate</em></h2><p>From the <a href=https://digital.grinnell.edu>https://digital.grinnell.edu</a> production site&mldr;</p><ul><li>Login as <code>System Admin</code></li><li>From the <code>Development</code> menu (on the right) select <code>Clear Cache</code></li><li>On the home page (<a href=https://digital.grinnell.edu>https://digital.grinnell.edu</a>), scroll to the bottom of the right-hand column.</li><li>Use the <code>Quick Backup</code> dialog, with all the defaults, to create and download a fresh backup.</li></ul><p>Alternatively, you could&mldr;</p><ul><li>Navigate to <a href=https://digital.grinnell.edu/admin/config/system/backup_migrate/export/advanced>https://digital.grinnell.edu/admin/config/system/backup_migrate/export/advanced</a></li><li>In the <code>Load Settings</code> box select <code>Default Settings w/ Users</code></li><li>Click <code>Backup now</code> to backup the site</li><li>Click <code>Save</code> to save the file to your workstation <code>Downloads</code> folder</li></ul><p>In the <a href=https://dg.localdomain>https://dg.localdomain</a> site&mldr;</p><ul><li>Visit <a href="https://dg.localdomain/#overlay=admin/config/system/backup_migrate/restore">#overlay=admin/config/system/backup_migrate/restore</a></li><li>Click the <code>Restore</code> tab</li><li>Select the <code>Restore from an uploaded file</code> option</li><li>Click <code>Browse</code> in the <code>Upload a Backup File</code></li><li>Navigate to your workstation <code>Downloads</code> folder and choose the backup file created moments ago</li><li>Click <code>Restore now</code></li><li>Navigate your browser back to <a href=https://dg.localdomain/>https://dg.localdomain/</a></li><li>Take note of any warnings or errors that may be present.</li></ul><h2 id=restore-resultslots-of-warnings>Restore Results&mldr;Lots of Warnings</h2><p>OK, so when I did all of the above backup/restore process what I got back in the &ldquo;Navigate your browser&mldr;&rdquo; step was an unreadable host of warnings. Without panic I very calmly returned to my terminal and the shell open in the <em>Apache</em> container and:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/default<br>drush cc all</td></tr></tbody></table><p>This returned a number of warnings about missing modules and such. No matter, that was to be expected and the full list of warnings is captured in <a href=https://gist.github.com/Digital-Grinnell/bc47f4528e702f1afeb58ceaab66b28c>this gist</a>.</p><p>The remedy for most of these missing bits was to do the following while still in my open <em>Apache</em> terminal/shell:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/default<br>drush dl masquerade announcements email git_deploy maillog r4032login smtp views_bootstrap admin_theme google_analytics_counter<br>drush cc all</td></tr></tbody></table><p>Visiting the <a href=https://dg.localdomain/>site</a> again shows that most of the <em>Drupal</em> missing modules are happy now, but there are still a number of <em>Islandora</em> bits missing, so I was left with the output as shown in <a href=https://gist.github.com/Digital-Grinnell/353fc06917db78d904a084b94d9b9982>this gist</a>.</p><p>Next steps and sections, still working &ldquo;off-script&rdquo;, will install all of these missing parts.</p><h2 id=installing-the-missing-islandora-and-custom-modules>Installing the Missing Islandora and Custom Modules</h2><p>If I recall correctly, all of the missing <em>Islandora</em> and custom modules listed above can be found in the <em>Apache</em> container on <em>DGDocker1</em>, our production instance of <em>ISLE</em>, at <code>/var/www/html/sites/all/modules/islandora</code>. So I started this process by opening a new shell in the aforementioned container on <em>DGDocker1</em> like so:</p><pre tabindex=0><code>╭─mcfatem@dgdocker1 ~
╰─$ docker exec -it isle-apache-dg bash
root@90ae0691e764:/# cd /var/www/html/sites/all/modules/islandora
root@90ae0691e764:/var/www/html/sites/all/modules/islandora# l
dg7/                                    islandora_multi_importer/            islandora_solution_pack_compound/
idu/                                    islandora_oai/                       islandora_solution_pack_disk_image/
islandora/                              islandora_object_lock/               islandora_solution_pack_entities/
islandora_bagit/                        islandora_ocr/                       islandora_solution_pack_image/
islandora_batch/                        islandora_openseadragon/             islandora_solution_pack_large_image/
islandora_binary_object/                islandora_paged_content/             islandora_solution_pack_newspaper/
islandora_book_batch/                   islandora_pathauto/                  islandora_solution_pack_oralhistories/
islandora_bookmark/                     islandora_pdfjs/                     islandora_solution_pack_pdf/
islandora_checksum/                     islandora_pdfjs_reader/              islandora_solution_pack_video/
islandora_checksum_checker/             islandora_premis/                    islandora_solution_pack_web_archive/
islandora_collection_search/            islandora_scholar/                   islandora_sync/
islandora_context/                      islandora_simple_workflow/           islandora_videojs/
islandora_feeds/                        islandora_solr_collection_view/      islandora_webform/
islandora_fits/                         islandora_solr_facet_pages/          islandora_xacml_editor/
islandora_image_annotation/             islandora_solr_metadata/             islandora_xml_forms/
islandora_importer/                     islandora_solr_search/               islandora_xmlsitemap/
islandora_internet_archive_bookreader/  islandora_solr_views/                islandora_xquery/
islandora_jwplayer/                     islandora_solution_pack_audio/       objective_forms/
islandora_marcxml/                      islandora_solution_pack_book/        php_lib/
</code></pre><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/all/modules/islandora<br>ls</td></tr></tbody></table><p>My recollection has been confirmed! So the next step was to visit each missing module&rsquo;s folder to see what <em>git</em> <code>remote</code> each is tied to, like so:</p><pre tabindex=0><code>root@90ae0691e764:/var/www/html/sites/all/modules/islandora# cd dg7; git remote -v
origin	https://github.com/DigitalGrinnell/dg7.git (fetch)
origin	https://github.com/DigitalGrinnell/dg7.git (push)
root@90ae0691e764:/var/www/html/sites/all/modules/islandora/dg7# cd ../idu; git remote -v
origin	https://github.com/DigitalGrinnell/idu.git (fetch)
origin	https://github.com/DigitalGrinnell/idu.git (push)
root@90ae0691e764:/var/www/html/sites/all/modules/islandora/idu# cd ../islandora_binary_object/; git remote -v
origin	git://github.com/discoverygarden/islandora_binary_object.git (fetch)
origin	git://github.com/discoverygarden/islandora_binary_object.git (push)
root@90ae0691e764:/var/www/html/sites/all/modules/islandora/islandora_binary_object# cd ../islandora_collection_search/; git remote -v
origin	https://github.com/discoverygarden/islandora_collection_search (fetch)
origin	https://github.com/discoverygarden/islandora_collection_search (push)
root@90ae0691e764:/var/www/html/sites/all/modules/islandora/islandora_collection_search# cd ../islandora_mods_display/; git remote -v
origin	https://github.com/DigitalGrinnell/islandora_mods_display.git (fetch)
origin	https://github.com/DigitalGrinnell/islandora_mods_display.git (push)
root@90ae0691e764:/var/www/html/sites/all/modules/islandora/islandora_mods_display# cd ../islandora_solution_pack_oralhistories/; git remote -v
origin	https://github.com/Islandora-Labs/islandora_solution_pack_oralhistories.git (fetch)
origin	https://github.com/Islandora-Labs/islandora_solution_pack_oralhistories.git (push)
root@90ae0691e764:/var/www/html/sites/all/modules/islandora/islandora_solution_pack_oralhistories# cd ../islandora_pdfjs_reader/; git remote -v
origin	git://github.com/nhart/islandora_pdfjs_reader.git (fetch)
origin	git://github.com/nhart/islandora_pdfjs_reader.git (push)
root@90ae0691e764:/var/www/html/sites/all/modules/islandora/islandora_pdfjs_reader# cd ../islandora_solr_collection_view/; git remote -v
origin	https://github.com/Islandora-Labs/islandora_solr_collection_view.git (fetch)
origin	https://github.com/Islandora-Labs/islandora_solr_collection_view.git (push)
</code></pre><table><thead><tr><th>Apache Container Commands (on <strong>PRODUCTION</strong> <em>ISLE</em> only!)*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/all/modules/islandora<br>cd dg7; git remote -v<br>cd ../idu; git remote -v<br>cd ../islandora_binary_object/; git remote -v<br>cd ../islandora_collection_search/; git remote -v<br>cd ../islandora_mods_display/; git remote -v<br>cd ../islandora_solution_pack_oralhistories/; git remote -v<br>cd ../islandora_pdfjs_reader/; git remote -v<br>cd ../islandora_solr_collection_view/; git remote -v</td></tr></tbody></table><p>Note that I did NOT bother with the <code>islandora_multi_importer</code> (IMI) directory since I know for a fact that IMI requires installation via <em>Composer</em>. I also didn&rsquo;t bother looking for <code>transcript_ui</code> because it is a known sub-module of <code>islandora_solution_pack_oralhistories</code>.</p><p>It looks like all of the others can just be added as <em>Git</em> submodules like so:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/all/modules/islandora<br>git submodule add <a href=https://github.com/DigitalGrinnell/dg7.git>https://github.com/DigitalGrinnell/dg7.git</a><br>git submodule add <a href=https://github.com/DigitalGrinnell/idu.git>https://github.com/DigitalGrinnell/idu.git</a><br># git submodule add git://github.com/discoverygarden/islandora_binary_object.git<br>git submodule add <a href=https://github.com/discoverygarden/islandora>https://github.com/discoverygarden/islandora</a>_collection_search<br>git submodule add <a href=https://github.com/DigitalGrinnell/islandora>https://github.com/DigitalGrinnell/islandora</a>_mods_display.git<br>git submodule add <a href=https://github.com/Islandora-Labs/islandora>https://github.com/Islandora-Labs/islandora</a>_solution_pack_oralhistories.git<br># git submodule add git://github.com/nhart/islandora_pdfjs_reader.git<br>git submodule add <a href=https://github.com/Islandora-Labs/islandora>https://github.com/Islandora-Labs/islandora</a>_solr_collection_view.git<br>chown -R islandora:www-data *<br>cd /var/www/html/sites/default<br>drush cc all</td></tr></tbody></table><p>The <code>chown</code> command line above was required to bring ALL of the new modules&rsquo; ownership into line with everything else in <a href=https://dg.localdomain/>dg.localdomain</a>. Also note that two of the lines, for <code>islandora_binary_object</code> and <code>islandora_pdfjs_reader</code>, are commented out because of known issues with installation of those modules.</p><h2 id=temporarily-eliminate-warnings>Temporarily Eliminate Warnings</h2><p>So my site, <a href=https://dg.localdomain/>https://dg.localdomain/</a>, is still issuing a few annoying warnings about missing pieces. It&rsquo;s a safe bet that we don&rsquo;t need these modules, at least not right now, so just do this:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/default<br>drush -y dis islandora_binary_object islandora_pdfjs_reader<br>drush sqlq &ldquo;DELETE FROM system WHERE name = &lsquo;islandora_binary_object&rsquo; AND type = &lsquo;module&rsquo;;&rdquo;<br>drush sqlq &ldquo;DELETE FROM system WHERE name = &lsquo;islandora_pdfjs_reader&rsquo; AND type = &lsquo;module&rsquo;;&rdquo;<br>drush sqlq &ldquo;DELETE FROM system WHERE name = &lsquo;islandora_google_scholar&rsquo; AND type = &lsquo;module&rsquo;;&rdquo;<br>drush sqlq &ldquo;DELETE FROM system WHERE name = &lsquo;phpexcel&rsquo; AND type = &lsquo;module&rsquo;;&rdquo;<br>drush sqlq &ldquo;DELETE FROM system WHERE name = &rsquo;ldap_servers&rsquo; AND type = &lsquo;module&rsquo;;&rdquo;<br>drush sqlq &ldquo;DELETE FROM system WHERE name = &lsquo;ihc&rsquo; AND type = &lsquo;module&rsquo;;&rdquo;<br>drush cc all<br>drush cc all</td></tr></tbody></table><p>You saw that correctly, I did <code>drush cc all</code> twice, just for good measure. Now, just a couple more issues to deal with&mldr;</p><h2 id=need-a-private-file-system>Need a <code>private</code> File System</h2><p>At this point the system is still issuing some warnings, and the most annoying is:</p><pre tabindex=0><code>Warning: file_put_contents(private:///.htaccess): failed to open stream: &amp;quot;DrupalPrivateStreamWrapper::stream_open&amp;quot; call failed in file_put_contents() (line 496 of /var/www/html/includes/file.inc).
</code></pre><p>A visit in my browser to <a href="https://dg.localdomain/#overlay=admin/reports/status">https://dg.localdomain/#overlay=admin/reports/status</a> helps to pinpoint the problem&mldr; we don&rsquo;t yet have a <code>private</code> file system. Let&rsquo;s create one like so:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www<br>mkdir private<br>chown islandora:www-data private<br>chmod 774 private<br>cd /var/www/html/sites/default<br>drush cc all</td></tr></tbody></table><p>Now that same status report, <a href="https://dg.localdomain/#overlay=admin/reports/status">https://dg.localdomain/#overlay=admin/reports/status</a>, shows that we are still operating in <code>maintenance mode</code>, and some of our newest modules may require database updates. To remedy those two conditions:</p><table><thead><tr><th>Apache Container Commands*</th></tr></thead><tbody><tr><td>cd /var/www/html/sites/default<br>drush updatedb -y<br>drush vset maintenance_mode 0<br>drush cc all</td></tr></tbody></table><h2 id=solr-schema-is-not-right>Solr Schema is NOT Right</h2><p>Ok, at this point I believe that I have a good <em>Drupal</em> database, a working <em>Fedora</em> repository, and a solid <em>Islandora/Drupal</em> codebase; but the <em>Solr</em> schema associated with this configuration is <strong>NOT</strong> up-to-speed with <em>Digital.Grinnell&rsquo;s</em> so the <code>dg7</code> code and the <code>dg7_collection</code> view are expecting <em>Solr</em> fields that do not yet exist here. What to do?</p><ol><li>Save the current database using <em>Backup and Migrate</em>.</li><li>Save the current codebase to the host using <code>mkdir -p ../dg-islandora; docker cp isle-apache-ld:/var/www/html/. ../dg-islandora</code> and putting all of it into a new <a href=https://github.com/Digital-Grinnell/dg-islandora>Digital-Grinnell/dg-islandora</a> repository on <em>GitHub</em> for safe-keeping.</li><li>Update the <em>FEDORA</em> and <em>Solr</em> schema and configuration using the guidance found in <a href=https://github.com/Digital-Grinnell/ISLE-DG-Essentials/blob/master/README.md>https://github.com/Digital-Grinnell/ISLE-DG-Essentials/blob/master/README.md</a></li><li>Try pulling up the <a href=https://dg.localdomain/>site</a> again.</li></ol><h1 id=huzzah-it-works>Huzzah! It works!</h1><h2 id=final-stepcapture-the-working-code-in-dg-islandora>Final Step&mldr;Capture the Working Code in <code>dg-islandora</code></h2><p>To wrap this up I followed <a href=https://github.com/Islandora-Collaboration-Group/ISLE/blob/ISLE-1.3.0/docs/install/install-local-new.md#step-11-check-in-the-newly-created-islandora-drupal-site-code-into-is-git-repository>Step 11 in the install-local-new.md</a> document to capture the state of my <em>Islandora/Drupal</em> code. In doing so I created my PRIVATE code repository, <a href=https://github.com/Digital-Grinnell/dg-islandora>dg-islandora</a>.</p><p>And that&rsquo;s a wrap. Until next time&mldr;</p></div><div class=post-footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//digital-library-applications-developer-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></main></body></html>