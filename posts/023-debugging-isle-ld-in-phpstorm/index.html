<!doctype html><html lang=en-us><head><title>Debugging ISLE-ld (Local Development) in PHPStorm // The Grinnell College Digital Library Application Developer's Blog</title><meta charset=utf-8><meta name=generator content="Hugo 0.96.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Mark A. McFate"><meta name=description content><link rel=stylesheet href=https://static.grinnell.edu/dlad-blog/css/main.min.ec5c8abc0625bee34a87b8624d3c683035583f8314d537f8d266c9f01ad58d83.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Debugging ISLE-ld (Local Development) in PHPStorm"><meta name=twitter:description content="Debugging ISLE on a Mac This guidance applies to debugging PHP code in a local ISLE-ld, that&rsquo;s http://isle.localdomain, instance using PHPStorm.
Modify ISLE&rsquo;s docker-compose.override.yml Before engaging PHPStorm we need to make one change to our ISLE-ld configuration by running a docker cp command, making a change to our docker-compose.override.yml file, and restarting the stack. Here are the commands and procedure.
   Workstation Commands     cd ~/Projects/ISLE  mkdir -p persistent/html  docker cp isle-apache-ld:/var/www/html/. ./persistent/html    The above commands will make a new ."><meta property="og:title" content="Debugging ISLE-ld (Local Development) in PHPStorm"><meta property="og:description" content="Debugging ISLE on a Mac This guidance applies to debugging PHP code in a local ISLE-ld, that&rsquo;s http://isle.localdomain, instance using PHPStorm.
Modify ISLE&rsquo;s docker-compose.override.yml Before engaging PHPStorm we need to make one change to our ISLE-ld configuration by running a docker cp command, making a change to our docker-compose.override.yml file, and restarting the stack. Here are the commands and procedure.
   Workstation Commands     cd ~/Projects/ISLE  mkdir -p persistent/html  docker cp isle-apache-ld:/var/www/html/. ./persistent/html    The above commands will make a new ."><meta property="og:type" content="article"><meta property="og:url" content="https://static.grinnell.edu/dlad-blog/posts/023-debugging-isle-ld-in-phpstorm/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-12T00:00:00+00:00"><meta property="article:modified_time" content="2019-07-12T00:00:00+00:00"></head><body><header class=app-header><a href=https://static.grinnell.edu/dlad-blog/><img class=app-header-avatar src=https://static.grinnell.edu/dlad-blog/avatar.jpg alt="Mark A. McFate"></a><h2>The Grinnell College Digital Library Application Developer's Blog</h2><div class=author-block><p class=site-rev>Compiled: Mar 29, 2022 at 1:35pm CDT<br>Content Updated: 2022-Mar-24 00:00 UTC</p><div class=name>by
<strong>Mark A. McFate</strong></div><div class=address>Grinnell College Libraries</div><div class=link><a href=mailto:></a></div><br></div><nav class=sidebar-nav><a class=sidebar-nav-item href=https://static.grinnell.edu/dlad-blog/search/ title>Search This Blog</a>
<a class=sidebar-nav-item href=https://static.grinnell.edu/dlad-blog/about/ title>About Me</a></nav><p class=site-description>Mark's first Hugo site, a blog, formerly at Static.Grinnell.edu, moved to DigitalOcean, and now hosted on Azure.</p><div class=app-header-social><a target=_blank href=https://github.com/McFateM><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a target=_blank href=https://twitter.com/gohugoio><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter"><title>twitter</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></div><p class=copyright>The views and opinions expressed on this site belong solely to the original author(s) and do not necessarily represent or reflect those of Grinnell College.</p></header><main class=app-container><div class=breadcrumbs><a href=https://static.grinnell.edu/dlad-blog/>Home</a>
&bull; <a href=https://static.grinnell.edu/dlad-blog/posts/>Posts</a>
&bull; <a href=https://static.grinnell.edu/dlad-blog/posts/023-debugging-isle-ld-in-phpstorm/>023 debugging isle ld in phpstorm</a></div><article class=post><header class=post-header><h1 class=post-title>Debugging ISLE-ld (Local Development) in PHPStorm</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>4 min read
&nbsp;&nbsp;&bull;&nbsp;&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
Jul 12, 2019
&nbsp;&nbsp;&bull;&nbsp;&nbsp;<strong><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-at-sign"><title>at-sign</title><circle cx="12" cy="12" r="4"/><path d="M16 8v5a3 3 0 006 0v-1a10 10 0 10-3.92 7.94"/></svg> Mark A. McFate</strong><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/docker-compose/>docker-compose</a><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/override/>override</a><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/isle/>ISLE</a><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/xdebug/>XDebug</a><a class=tag href=https://static.grinnell.edu/dlad-blog/tags/phpstorm/>PHPStorm</a></div></div></header><div class=post-content><h1 id=debugging-isle-on-a-mac>Debugging ISLE on a Mac</h1><p>This guidance applies to debugging PHP code in a local <code>ISLE-ld</code>, that&rsquo;s <a href=http://isle.localdomain>http://isle.localdomain</a>, instance using <a href=https://www.jetbrains.com/phpstorm/>PHPStorm</a>.</p><h2 id=modify-isles-docker-composeoverrideyml>Modify ISLE&rsquo;s <code>docker-compose.override.yml</code></h2><p>Before engaging <em>PHPStorm</em> we need to make one change to our <code>ISLE-ld</code> configuration by running a <code>docker cp</code> command, making a change to our <code>docker-compose.override.yml</code> file, and restarting the stack. Here are the commands and procedure.</p><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>cd ~/Projects/ISLE<br>mkdir -p persistent/html<br>docker cp isle-apache-ld:/var/www/html/. ./persistent/html</td></tr></tbody></table><p>The above commands will make a new <code>./persistent/html</code> directory on the host, if one does not already exist, and the <code>docker cp</code> command will copy the current contents of the <em>Apache</em> container&rsquo;s <code>/var/www/html</code> directory to the host. Next we need to modify <code>docker-compose.override.yml</code> to map the <code>./persistent/html</code> directory into the container.</p><p>On the host, open <code>docker-compose.override.yml</code> in your favorite editor and remove comments from the three lines that read:</p><ul><li>  apache:</li><li>    volumes:</li><li>      ./persistent/html:/var/www/html # necessary for PHPStorm debugging!</li></ul><table><thead><tr><th>Important!</th></tr></thead><tbody><tr><td>Proper indentation in <code>docker-compose.override.yml</code>, like all .yml files, is <strong>CRITICAL</strong>! There should be 2 spaces (one tab) at the start of the <code>apache:</code> line, 4 spaces before <code>volumes:</code>, and 6 spaces before <code>.persistent...</code>.</td></tr></tbody></table><p>Having saved the modified <code>docker-compose.override.yml</code> file, restart things by doing the following.</p><table><thead><tr><th>Workstation Commands</th></tr></thead><tbody><tr><td>cd ~/Projects/ISLE<br>docker-compose down<br>docker-compose up -d</td></tr></tbody></table><p>In a minute or two your <code>http://isle.localdomain</code> should be back up and running, and ready for debugging in <em>PHPStorm</em>.</p><h2 id=phpstorm-configuration>PHPStorm Configuration</h2><p>In the <em>PHPStorm</em> menu go to: <code>Preferences > Languages & Frameworks > PHP > Debug > DBGp Proxy</code> and set the following settings:</p><pre><code>IDE key: `PHPSTORM`
Host: `docker.for.mac.localhost`
Port: `9009`
</code></pre><p>Next, we need to configure a server. This is how <em>PHPStorm</em> will map the file paths in your local system to the ones in your container.</p><p>The following is a ONE TIME procedure. If you&rsquo;ve already done this then all you need to do is select the <em>PHPStorm</em> project, one you created and named earlier, from the <em>PHPStorm</em> splash screen.</p><ul><li>From the <em>PHPStorm</em> splash screen choose <code>Create New Project from Existing Files</code>. Click <code>Next</code>.</li><li><strong>CRITICAL</strong>&mldr;<em>pay attention to this!</em> Select <code>Source files are in a local directory, no Web server is yet configured.</code>. Click <code>Next</code>.</li><li>A directory map of your host should appear. Navigate in this map to your <strong>ISLE</strong> project, the folder where your <code>docker-compose.yml</code> file exists. There should also be a <code>./persistent/html</code> folder there from steps we took in the previous section. Choose the <code>html</code> folder, click <code>Project Root</code>, then click <code>Finish</code>.</li><li>You now have a new &ldquo;local&rdquo; project named <code>html</code>.</li><li>Relax a little while your <em>PHPStorm</em> project is indexed for the first time.</li></ul><h2 id=launching-a-web-debug-session>Launching a Web Debug Session</h2><p>Once you&rsquo;re all setup and have your PHPStorm project open&mldr;</p><ul><li>Set breakpoints in your code, toggle <code>Start listening for PHP connections</code> on (the green/red telephone icon). When turned on the red parts of the icon turn green.</li><li>Open the <code>Run</code> menu in PHPStorm and look near the bottom of the window for the <code>Break at first line in PHP scripts</code> option. Ensure that it is toggled <code>ON</code> so that your debug session will encouter at least one breakpoint.</li><li>Now open your browser and navigate to your site (mine is <code>http://isle.localdomain</code>).</li><li>In PHPStorm you may see a pop-up window titled <code>Incoming Connection from XDebug</code>. Click <code>Accept</code>.</li><li>If everything is working properly your PHPStorm <code>Debug</code> window pane will open and if you click the <code>Debugger</code> tab you&rsquo;ll see your <code>index.php</code> code and a cursor with the first line of code highlighted, usually: <code>define('DRUPAL_ROOT', getcwd());</code>.</li></ul><h2 id=debugging-cli-aka-drush-commands>Debugging CLI (aka Drush) Commands</h2><p>Visit the <em>PHPStorm</em> menu <code>Preferences > Languages & Frameworks > PHP > Servers</code> and add a server named <code>Docker</code> with the following parameters:</p><ul><li>Host: <code>docker.for.mac.localhost</code></li><li>Port: <code>80</code></li><li>Debugger: <code>Xdebug</code></li><li>Use path mappings: <code>Checked</code><ul><li>File/Directory: <code>/Users/mark/ISLE-ld/html</code></li><li>Absolute path on server: <code>/var/www/html</code></li></ul></li></ul><p>Open a terminal into the <code>isle-apache-ld</code> container and run <code>export PHP_IDE_CONFIG=serverName=Docker</code> to complete the configuration.</p><p>Set breakpoints in your <em>Drush</em> code and run any <code>drush</code> command in the same <code>isle-apache-ld</code> terminal with debug listening toggled on in <em>PHPStorm</em>.</p><p>And that&rsquo;s a wrap. Until next time&mldr;</p></div><div class=post-footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//digital-library-applications-developer-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></main></body></html>